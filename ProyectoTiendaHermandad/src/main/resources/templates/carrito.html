<!DOCTYPE html>
<html lang="es" xmlns:th="https://www.thymeleaf.org">

<head>
    <title>Hermandad de la estrella</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        th:href="@{https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css}">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css"
        th:href="@{https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css}">
    <link rel="shortcut icon" href="static/img/escudo.png" th:href="@{img/escudo.png}">
    <link rel="stylesheet" href="../static/css/estilos.css" type="text/css" th:href="@{/css/estilos.css}">
</head>

<body>
    <!-- Pintamos la tabla con los diferentes productos que se van añadiendo al carrito -->
    <div class="container-fluid">
        <header class="w-100" th:replace="~{fragmentos/encabezado::encabezado}">
        </header>
        <h2 class="texto">Listado de Productos</h2>
        <table class="table tablaHermanos mw-100">
            <thead>
                <tr>
                    <th>Nombre</th>
                    <th>Precio Unitario</th>
                    <th>Unidades</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody>
                <tr class="tabla" th:each="producto : ${productos.entrySet}">
                    <td class="anchoCelda" th:text="${productos.key.nombre}">Nombre</td>
                    <td th:text="${#numbers.formatCurrency(productos.key.pvp)}">Nombre</td>
                    <td th:text="${producto.unidadesStock}">Nombre</td>
                    <td><button type="button" class="btn btn-danger" data-bs-toggle="modal"
                            th:attr="data-bs-target='#myModal'+${producto.id}">Eliminar</button></td>
                    <td class="col-sm-1 col-md-1 text-center"><strong
                            th:text="${producto.key.pvp * element.value}">$14.61</strong></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <h4>Total</h4>
                    <!-- The Modal -->
                    <div class="modal" id="myModal" th:id="'myModal'+${producto.id}">
                        <div class="modal-dialog">
                            <div class="modal-content">

                                <!-- Modal Header -->
                                <div class="modal-header">
                                    <h4 class="modal-title">Modal Heading</h4>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>

                                <!-- Modal body -->
                                <div class="modal-body">¿Esta seguro que desea eliminar
                                    este producto?</div>

                                <!-- Modal footer -->
                                <div class="modal-footer">
                                    <a class="btn btn-danger"
                                        th:href="@{/borrarProducto/{id}(id=${producto.id})}">Eliminar</a>
                                    <a class="btn btn-secundary" th:href="@{/carrito}">Volver</a>
                                </div>

                            </div>
                        </div>
                    </div>
                </tr>
            </tbody>
        </table>
        <br>
    </div>
</body>


</html>

<!-- Bucle que va sacando los distintos elementos guardados en el carrito. 
                Recordemos que es un HashMap cuya clave es un  producto 
                y cuyo valor es la cantidad de productos, por eso
                vamos sacando un elemento del carrito, esto significa que element, es tipo Entry, es decir,
                pareja clave-valor "entera" (producto-cantidad), por todo esto, cuando queremos, por ejemplo, 
                mostrar el nombre del producto, accedemos mediante: 
                ${element.key.nombre} ya que sacamos la clave de la pareja "entry" que es un producto, 
                y a su vez, accedemos al tributo nombre de ese producto -->

<!-- Como se puede ver en el manual de Th y hablamos en clase, en th se pueden hacer operaciones básicas con variables
                        como en java, por lo que se puede multiplicar un valor por otro, como por ejemplo, aquí en precio por cantidad -->

<td class="col-sm-1 col-md-1 text-center"><strong th:text="${element.key.pvp * element.value}">$14.61</strong></td>
<td class="col-sm-1 col-md-1">


    <button type="button" class="btn btn-danger">
        <span class="glyphicon glyphicon-remove"></span> Remove
    </button>
</td>
</tr>
<tr>
    <td>   </td>
    <td>   </td>
    <td>   </td>
    <td>
        <h3>Total</h3>
    </td>
    <td class="text-right">
        <h3><strong th:text="${total_carrito}">100€</strong></h3>
    </td>
</tr>
<tr>
    <td>   </td>
    <td>   </td>
    <td>   </td>
    <td>
        <button type="button" class="btn btn-default">
            <span class="glyphicon glyphicon-shopping-cart"></span> Continue Shopping
        </button>
    </td>
    <td>
        <button type="button" class="btn btn-success">
            Checkout <span class="glyphicon glyphicon-play"></span>
        </button>
    </td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<!-- /.container -->


<!-- Bootstrap core JavaScript
    ================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
</body>

</html>